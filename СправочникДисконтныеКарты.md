# Справочник "Дисконтные карты"

## Структура справочника

### Основные реквизиты:
- **Наименование** (Строка) - название/номер дисконтной карты
- **КодКартыШтрихкод** (Строка) - штрихкод карты
- **ВладелецКарты** (СправочникСсылка.Контрагенты) - ссылка на контрагента-владельца
- **ВидДисконтнойКарты** (СправочникСсылка.ВидыДисконтныхКарт) - ссылка на вид карты

### Связанные справочники:
- **Контрагенты** - справочник контрагентов с реквизитами:
  - Наименование (ФИО владельца)
  - Телефон (номер телефона)
- **ВидыДисконтныхКарт** - справочник видов дисконтных карт с реквизитом:
  - Наименование (название вида скидки)

## Формат Excel файла

Excel файл должен содержать следующие колонки в указанном порядке:

| Колонка | Название | Описание |
|---------|----------|----------|
| A | НомерКарты | Номер/название карты |
| B | Телефон | Номер телефона владельца |
| C | ФИОВладельца | ФИО владельца карты |
| D | Штрихкод | Штрихкод карты |
| E | ВидСкидки | Вид предоставляемой скидки |

### Пример данных:
```
НомерКарты | Телефон      | ФИОВладельца    | Штрихкод    | ВидСкидки
DC001      | +7(999)123-45-67 | Иванов И.И. | 1234567890 | 5%
DC002      | +7(999)234-56-78 | Петров П.П. | 2345678901 | 10%
```

## Логика работы обработки

1. **Создание/поиск контрагента**:
   - Ищет контрагента по ФИО в справочнике Контрагенты
   - Если не найден - создает нового с ФИО и телефоном

2. **Создание/поиск вида карты**:
   - Ищет вид карты по наименованию в справочнике ВидыДисконтныхКарт
   - Если не найден - создает новый вид

3. **Создание/обновление карты**:
   - Ищет карту по штрихкоду в справочнике ДисконтныеКарты
   - Если не найдена - создает новую
   - Заполняет: Наименование, КодКартыШтрихкод, ВладелецКарты, ВидДисконтнойКарты

## Особенности работы обработки

1. **Проверка обязательных полей**: НомерКарты и ФИОВладельца обязательны для заполнения
2. **Автоматическое создание контрагентов**: Если контрагент не найден, создается новый
3. **Автоматическое создание видов карт**: Если вид карты не найден, создается новый
4. **Обновление существующих записей**: Если карта с таким штрихкодом уже существует, данные обновляются
5. **Создание новых записей**: Если карты с таким штрихкодом нет, создается новая запись
6. **Обработка ошибок**: Строки с ошибками пропускаются, ведется подсчет ошибок
7. **Статистика**: Отображается количество созданных записей и количество ошибок

## Требования к системе

- Установленный Microsoft Excel
- Права на создание COM объектов
- Доступ к справочникам: ДисконтныеКарты, Контрагенты, ВидыДисконтныхКарт
- Права на создание записей в справочниках 